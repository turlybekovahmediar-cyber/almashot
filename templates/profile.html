<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SHOOT — Профиль</title>
  <link rel="stylesheet" href="{{url_for('static', filename='profile.css')}}">
</head>
<body class="shoot-bg">

  <header class="topbar">
  <a class="logo" href="{{url_for('index')}}"><img src="{{url_for('static', filename='img/logo.png')}}" alt="SHOOT" /></a>

  <nav class="nav">
    <a class="nav__link" href="{{url_for('index')}}">Главная</a>
    <a class="nav__link" href="{{url_for('favorites')}}">Избранное</a>
    <a class="nav__link" href="{{url_for('history')}}">История</a>
  </nav>

  <div class="auth">
    <!-- показываем, если профиля нет -->
    <a class="btn btn--outline" id="loginBtn" href="{{url_for('login')}}">Войти</a>

    <!-- показываем, если профиль есть -->
    <button class="userchip userchip--icon" id="userChip" hidden aria-haspopup="true" aria-expanded="false">
      <span class="userchip__avatar" id="chipAvatar" aria-hidden="true">U</span>
      <span class="userchip__caret">▾</span>
    </button>

    <!-- поповер-«карточка» -->
    <div class="account-popover" id="accountPopover" hidden>
      <div class="acc-row acc-main">
        <span class="acc-avatar" id="popAvatar">U</span>
        <div class="acc-id">
          <div class="acc-name" id="popName"> {{user.username}} </div>
          <div class="acc-email" id="popEmail">{{user.email}}</div>
        </div>
        <span class="acc-check">✓</span>
      </div>
      <div class="acc-divider"></div>
      <a class="acc-item" href="{{url_for('profile')}}">Профиль</a>
      <button class="acc-item acc-danger" id="logoutBtn" type="button">Выйти</button>
    </div>
  </div>
</header>

  <main class="wrap">
    <section class="card account" id="accountCard">
      <button class="close" onclick="history.back()" aria-label="Назад">×</button>

      <header class="account__head">
        <label class="avatar-uploader" id="avatarUploader" title="Нажмите, чтобы изменить фото">
          <input id="avatarFile" type="file" accept="image/*" disabled>
          <img id="avatarImg" alt="Avatar">
          <div class="avatar-fallback" id="avatarFallback">A</div>
          <span class="avatar-edit">изменить</span>
        </label>

        <div>
          <h2 id="fullNameTitle">{{user.username}}</h2>
          <p class="muted" id="emailSub"> {{user.email}} </p>
        </div>
      </header>

      <hr>

      <div class="grid">
        <label class="row">
          <span>Имя</span>
          <input id="firstName" placeholder="{{user.username}}" disabled>
        </label>

        <label class="row">
          <span>Email</span>
          <input id="email" type="email" placeholder="{{user.email}}" disabled>
        </label>

        <div class="row">
          <span>Пароль</span>
          <div class="pass">
            <input id="password" type="password" placeholder="●●●●●●●●" disabled>
            <button id="togglePass" type="button" class="link">Открыть пароль</button>
          </div>
        </div>

      </div>

      <footer class="actions">
        <button id="editBtn" class="btn btn--ghost">Редактировать</button>
        <button id="saveBtn" class="btn" hidden>Сохранить</button>
        <button id="cancelBtn" class="btn btn--light" hidden>Отмена</button>
      </footer>
    </section>
  </main>

  <div id="toast" class="toast">Сохранено</div>
  <footer class="footer">
    <div>
      <div class="logo"><img src="{{url_for('static', filename='img/logo.png')}}" alt="SHOOT"></div>
      <p class="footer__text">Лучшие идеи для отдыха, развлечении и вдохновения каждый день</p>
      <div class="socials">
        <a href="#"><img src="{{url_for('static', filename='img/инста.png')}}" alt="Instagram"></a>
        <a href="#"><img src="{{url_for('static', filename='img/ватсап.png')}}" alt="WhatsApp"></a>
        <a href="#"><img src="{{url_for('static', filename='img/телега.png')}}" alt="Telegram"></a>
      </div>
    </div>

    <div>
      <div class="footer__title">Навигация</div>
      <nav class="links">
        <a href="{{url_for('index')}}">Главная</a>
        <a href="{{url_for('favorites')}}">Избранное</a>
        <a href="{{url_for('profile')}}">Профиль</a>
      </nav>
    </div>

    <div>
      <div class="footer__title">О проекте</div>
      <nav class="links">
        <a href="{{url_for('faq')}}">FAQ</a>
      </nav>
    </div>
  </footer>
 <script>
  const user = {{ (current_user.to_dict() if current_user.is_authenticated else None) | tojson | safe }};
</script>
 <script src="{{url_for('static', filename='profile.js')}}" defer></script>
 <script src="{{url_for('static', filename='script.js')}}" defer></script>

</body>
</html>
